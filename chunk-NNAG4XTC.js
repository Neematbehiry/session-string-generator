import{A as S,B as C,X as v,Y as g,c as L,d as T,k as E,l as R,w as $,z as y}from"./chunk-LT2JLGES.js";var J=Object.create,M=Object.defineProperty,Q=Object.getOwnPropertyDescriptor,X=Object.getOwnPropertyNames,Y=Object.getPrototypeOf,Z=Object.prototype.hasOwnProperty,rr=(a,s)=>()=>(s||a((s={exports:{}}).exports,s),s.exports),er=(a,s)=>{for(var f in s)M(a,f,{get:s[f],enumerable:!0})},D=(a,s,f,p)=>{if(s&&typeof s=="object"||typeof s=="function")for(let c of X(s))!Z.call(a,c)&&c!==f&&M(a,c,{get:()=>s[c],enumerable:!(p=Q(s,c))||p.enumerable});return a},tr=(a,s,f)=>(D(a,s,"default"),f&&D(f,s,"default")),V=(a,s,f)=>(f=a!=null?J(Y(a)):{},D(s||!a||!a.__esModule?M(f,"default",{value:a,enumerable:!0}):f,a)),_=rr((a,s)=>{(function(f){"use strict";let p="(0?\\d+|0x[a-f0-9]+)",c={fourOctet:new RegExp(`^${p}\\.${p}\\.${p}\\.${p}$`,"i"),threeOctet:new RegExp(`^${p}\\.${p}\\.${p}$`,"i"),twoOctet:new RegExp(`^${p}\\.${p}$`,"i"),longValue:new RegExp(`^${p}$`,"i")},h=new RegExp("^0[0-7]+$","i"),d=new RegExp("^0x[a-f0-9]+$","i"),w="%[0-9a-z]{1,}",A="(?:[0-9a-f]+::?)+",m={zoneIndex:new RegExp(w,"i"),native:new RegExp(`^(::)?(${A})?([0-9a-f]+)?(::)?(${w})?$`,"i"),deprecatedTransitional:new RegExp(`^(?:::)(${p}\\.${p}\\.${p}\\.${p}(${w})?)$`,"i"),transitional:new RegExp(`^((?:${A})|(?:::)(?:${A})?)${p}\\.${p}\\.${p}\\.${p}(${w})?$`,"i")};function B(r,e){if(r.indexOf("::")!==r.lastIndexOf("::"))return null;let n=0,t=-1,o=(r.match(m.zoneIndex)||[])[0],i,l;for(o&&(o=o.substring(1),r=r.replace(/%.+$/,""));(t=r.indexOf(":",t+1))>=0;)n++;if(r.substr(0,2)==="::"&&n--,r.substr(-2,2)==="::"&&n--,n>e)return null;for(l=e-n,i=":";l--;)i+="0:";return r=r.replace("::",i),r[0]===":"&&(r=r.slice(1)),r[r.length-1]===":"&&(r=r.slice(0,-1)),e=function(){let k=r.split(":"),z=[];for(let x=0;x<k.length;x++)z.push(parseInt(k[x],16));return z}(),{parts:e,zoneId:o}}function F(r,e,n,t){if(r.length!==e.length)throw new Error("ipaddr: cannot match CIDR for objects with different lengths");let o=0,i;for(;t>0;){if(i=n-t,i<0&&(i=0),r[o]>>i!==e[o]>>i)return!1;t-=n,o+=1}return!0}function I(r){if(d.test(r))return parseInt(r,16);if(r[0]==="0"&&!isNaN(parseInt(r[1],10))){if(h.test(r))return parseInt(r,8);throw new Error(`ipaddr: cannot parse ${r} as octal`)}return parseInt(r,10)}function H(r,e){for(;r.length<e;)r=`0${r}`;return r}let u={};u.IPv4=function(){function r(e){if(e.length!==4)throw new Error("ipaddr: ipv4 octet count should be 4");let n,t;for(n=0;n<e.length;n++)if(t=e[n],!(0<=t&&t<=255))throw new Error("ipaddr: ipv4 octet should fit in 8 bits");this.octets=e}return r.prototype.SpecialRanges={unspecified:[[new r([0,0,0,0]),8]],broadcast:[[new r([255,255,255,255]),32]],multicast:[[new r([224,0,0,0]),4]],linkLocal:[[new r([169,254,0,0]),16]],loopback:[[new r([127,0,0,0]),8]],carrierGradeNat:[[new r([100,64,0,0]),10]],private:[[new r([10,0,0,0]),8],[new r([172,16,0,0]),12],[new r([192,168,0,0]),16]],reserved:[[new r([192,0,0,0]),24],[new r([192,0,2,0]),24],[new r([192,88,99,0]),24],[new r([198,18,0,0]),15],[new r([198,51,100,0]),24],[new r([203,0,113,0]),24],[new r([240,0,0,0]),4]]},r.prototype.kind=function(){return"ipv4"},r.prototype.match=function(e,n){let t;if(n===void 0&&(t=e,e=t[0],n=t[1]),e.kind()!=="ipv4")throw new Error("ipaddr: cannot match ipv4 address with non-ipv4 one");return F(this.octets,e.octets,8,n)},r.prototype.prefixLengthFromSubnetMask=function(){let e=0,n=!1,t={0:8,128:7,192:6,224:5,240:4,248:3,252:2,254:1,255:0},o,i,l;for(o=3;o>=0;o-=1)if(i=this.octets[o],i in t){if(l=t[i],n&&l!==0)return null;l!==8&&(n=!0),e+=l}else return null;return 32-e},r.prototype.range=function(){return u.subnetMatch(this,this.SpecialRanges)},r.prototype.toByteArray=function(){return this.octets.slice(0)},r.prototype.toIPv4MappedAddress=function(){return u.IPv6.parse(`::ffff:${this.toString()}`)},r.prototype.toNormalizedString=function(){return this.toString()},r.prototype.toString=function(){return this.octets.join(".")},r}(),u.IPv4.broadcastAddressFromCIDR=function(r){try{let e=this.parseCIDR(r),n=e[0].toByteArray(),t=this.subnetMaskFromPrefixLength(e[1]).toByteArray(),o=[],i=0;for(;i<4;)o.push(parseInt(n[i],10)|parseInt(t[i],10)^255),i++;return new this(o)}catch{throw new Error("ipaddr: the address does not have IPv4 CIDR format")}},u.IPv4.isIPv4=function(r){return this.parser(r)!==null},u.IPv4.isValid=function(r){try{return new this(this.parser(r)),!0}catch{return!1}},u.IPv4.isValidFourPartDecimal=function(r){return!!(u.IPv4.isValid(r)&&r.match(/^(0|[1-9]\d*)(\.(0|[1-9]\d*)){3}$/))},u.IPv4.networkAddressFromCIDR=function(r){let e,n,t,o,i;try{for(e=this.parseCIDR(r),t=e[0].toByteArray(),i=this.subnetMaskFromPrefixLength(e[1]).toByteArray(),o=[],n=0;n<4;)o.push(parseInt(t[n],10)&parseInt(i[n],10)),n++;return new this(o)}catch{throw new Error("ipaddr: the address does not have IPv4 CIDR format")}},u.IPv4.parse=function(r){let e=this.parser(r);if(e===null)throw new Error("ipaddr: string is not formatted like an IPv4 Address");return new this(e)},u.IPv4.parseCIDR=function(r){let e;if(e=r.match(/^(.+)\/(\d+)$/)){let n=parseInt(e[2]);if(n>=0&&n<=32){let t=[this.parse(e[1]),n];return Object.defineProperty(t,"toString",{value:function(){return this.join("/")}}),t}}throw new Error("ipaddr: string is not formatted like an IPv4 CIDR range")},u.IPv4.parser=function(r){let e,n,t;if(e=r.match(c.fourOctet))return function(){let o=e.slice(1,6),i=[];for(let l=0;l<o.length;l++)n=o[l],i.push(I(n));return i}();if(e=r.match(c.longValue)){if(t=I(e[1]),t>4294967295||t<0)throw new Error("ipaddr: address outside defined range");return function(){let o=[],i;for(i=0;i<=24;i+=8)o.push(t>>i&255);return o}().reverse()}else return(e=r.match(c.twoOctet))?function(){let o=e.slice(1,4),i=[];if(t=I(o[1]),t>16777215||t<0)throw new Error("ipaddr: address outside defined range");return i.push(I(o[0])),i.push(t>>16&255),i.push(t>>8&255),i.push(t&255),i}():(e=r.match(c.threeOctet))?function(){let o=e.slice(1,5),i=[];if(t=I(o[2]),t>65535||t<0)throw new Error("ipaddr: address outside defined range");return i.push(I(o[0])),i.push(I(o[1])),i.push(t>>8&255),i.push(t&255),i}():null},u.IPv4.subnetMaskFromPrefixLength=function(r){if(r=parseInt(r),r<0||r>32)throw new Error("ipaddr: invalid IPv4 prefix length");let e=[0,0,0,0],n=0,t=Math.floor(r/8);for(;n<t;)e[n]=255,n++;return t<4&&(e[t]=Math.pow(2,r%8)-1<<8-r%8),new this(e)},u.IPv6=function(){function r(e,n){let t,o;if(e.length===16)for(this.parts=[],t=0;t<=14;t+=2)this.parts.push(e[t]<<8|e[t+1]);else if(e.length===8)this.parts=e;else throw new Error("ipaddr: ipv6 part count should be 8 or 16");for(t=0;t<this.parts.length;t++)if(o=this.parts[t],!(0<=o&&o<=65535))throw new Error("ipaddr: ipv6 part should fit in 16 bits");n&&(this.zoneId=n)}return r.prototype.SpecialRanges={unspecified:[new r([0,0,0,0,0,0,0,0]),128],linkLocal:[new r([65152,0,0,0,0,0,0,0]),10],multicast:[new r([65280,0,0,0,0,0,0,0]),8],loopback:[new r([0,0,0,0,0,0,0,1]),128],uniqueLocal:[new r([64512,0,0,0,0,0,0,0]),7],ipv4Mapped:[new r([0,0,0,0,0,65535,0,0]),96],rfc6145:[new r([0,0,0,0,65535,0,0,0]),96],rfc6052:[new r([100,65435,0,0,0,0,0,0]),96],"6to4":[new r([8194,0,0,0,0,0,0,0]),16],teredo:[new r([8193,0,0,0,0,0,0,0]),32],reserved:[[new r([8193,3512,0,0,0,0,0,0]),32]],benchmarking:[new r([8193,2,0,0,0,0,0,0]),48],amt:[new r([8193,3,0,0,0,0,0,0]),32],as112v6:[new r([8193,4,274,0,0,0,0,0]),48],deprecated:[new r([8193,16,0,0,0,0,0,0]),28],orchid2:[new r([8193,32,0,0,0,0,0,0]),28]},r.prototype.isIPv4MappedAddress=function(){return this.range()==="ipv4Mapped"},r.prototype.kind=function(){return"ipv6"},r.prototype.match=function(e,n){let t;if(n===void 0&&(t=e,e=t[0],n=t[1]),e.kind()!=="ipv6")throw new Error("ipaddr: cannot match ipv6 address with non-ipv6 one");return F(this.parts,e.parts,16,n)},r.prototype.prefixLengthFromSubnetMask=function(){let e=0,n=!1,t={0:16,32768:15,49152:14,57344:13,61440:12,63488:11,64512:10,65024:9,65280:8,65408:7,65472:6,65504:5,65520:4,65528:3,65532:2,65534:1,65535:0},o,i;for(let l=7;l>=0;l-=1)if(o=this.parts[l],o in t){if(i=t[o],n&&i!==0)return null;i!==16&&(n=!0),e+=i}else return null;return 128-e},r.prototype.range=function(){return u.subnetMatch(this,this.SpecialRanges)},r.prototype.toByteArray=function(){let e,n=[],t=this.parts;for(let o=0;o<t.length;o++)e=t[o],n.push(e>>8),n.push(e&255);return n},r.prototype.toFixedLengthString=function(){let e=(function(){let t=[];for(let o=0;o<this.parts.length;o++)t.push(H(this.parts[o].toString(16),4));return t}).call(this).join(":"),n="";return this.zoneId&&(n=`%${this.zoneId}`),e+n},r.prototype.toIPv4Address=function(){if(!this.isIPv4MappedAddress())throw new Error("ipaddr: trying to convert a generic ipv6 address to ipv4");let e=this.parts.slice(-2),n=e[0],t=e[1];return new u.IPv4([n>>8,n&255,t>>8,t&255])},r.prototype.toNormalizedString=function(){let e=(function(){let t=[];for(let o=0;o<this.parts.length;o++)t.push(this.parts[o].toString(16));return t}).call(this).join(":"),n="";return this.zoneId&&(n=`%${this.zoneId}`),e+n},r.prototype.toRFC5952String=function(){let e=/((^|:)(0(:|$)){2,})/g,n=this.toNormalizedString(),t=0,o=-1,i;for(;i=e.exec(n);)i[0].length>o&&(t=i.index,o=i[0].length);return o<0?n:`${n.substring(0,t)}::${n.substring(t+o)}`},r.prototype.toString=function(){return this.toRFC5952String()},r}(),u.IPv6.broadcastAddressFromCIDR=function(r){try{let e=this.parseCIDR(r),n=e[0].toByteArray(),t=this.subnetMaskFromPrefixLength(e[1]).toByteArray(),o=[],i=0;for(;i<16;)o.push(parseInt(n[i],10)|parseInt(t[i],10)^255),i++;return new this(o)}catch(e){throw new Error(`ipaddr: the address does not have IPv6 CIDR format (${e})`)}},u.IPv6.isIPv6=function(r){return this.parser(r)!==null},u.IPv6.isValid=function(r){if(typeof r=="string"&&r.indexOf(":")===-1)return!1;try{let e=this.parser(r);return new this(e.parts,e.zoneId),!0}catch{return!1}},u.IPv6.networkAddressFromCIDR=function(r){let e,n,t,o,i;try{for(e=this.parseCIDR(r),t=e[0].toByteArray(),i=this.subnetMaskFromPrefixLength(e[1]).toByteArray(),o=[],n=0;n<16;)o.push(parseInt(t[n],10)&parseInt(i[n],10)),n++;return new this(o)}catch(l){throw new Error(`ipaddr: the address does not have IPv6 CIDR format (${l})`)}},u.IPv6.parse=function(r){let e=this.parser(r);if(e.parts===null)throw new Error("ipaddr: string is not formatted like an IPv6 Address");return new this(e.parts,e.zoneId)},u.IPv6.parseCIDR=function(r){let e,n,t;if((n=r.match(/^(.+)\/(\d+)$/))&&(e=parseInt(n[2]),e>=0&&e<=128))return t=[this.parse(n[1]),e],Object.defineProperty(t,"toString",{value:function(){return this.join("/")}}),t;throw new Error("ipaddr: string is not formatted like an IPv6 CIDR range")},u.IPv6.parser=function(r){let e,n,t,o,i,l;if(t=r.match(m.deprecatedTransitional))return this.parser(`::ffff:${t[1]}`);if(m.native.test(r))return B(r,8);if((t=r.match(m.transitional))&&(l=t[6]||"",e=B(t[1].slice(0,-1)+l,6),e.parts)){for(i=[parseInt(t[2]),parseInt(t[3]),parseInt(t[4]),parseInt(t[5])],n=0;n<i.length;n++)if(o=i[n],!(0<=o&&o<=255))return null;return e.parts.push(i[0]<<8|i[1]),e.parts.push(i[2]<<8|i[3]),{parts:e.parts,zoneId:e.zoneId}}return null},u.IPv6.subnetMaskFromPrefixLength=function(r){if(r=parseInt(r),r<0||r>128)throw new Error("ipaddr: invalid IPv6 prefix length");let e=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],n=0,t=Math.floor(r/8);for(;n<t;)e[n]=255,n++;return t<16&&(e[t]=Math.pow(2,r%8)-1<<8-r%8),new this(e)},u.fromByteArray=function(r){let e=r.length;if(e===4)return new u.IPv4(r);if(e===16)return new u.IPv6(r);throw new Error("ipaddr: the binary input is neither an IPv6 nor IPv4 address")},u.isValid=function(r){return u.IPv6.isValid(r)||u.IPv4.isValid(r)},u.parse=function(r){if(u.IPv6.isValid(r))return u.IPv6.parse(r);if(u.IPv4.isValid(r))return u.IPv4.parse(r);throw new Error("ipaddr: the address has neither IPv6 nor IPv4 format")},u.parseCIDR=function(r){try{return u.IPv6.parseCIDR(r)}catch{try{return u.IPv4.parseCIDR(r)}catch{throw new Error("ipaddr: the address has neither IPv6 nor IPv4 CIDR format")}}},u.process=function(r){let e=this.parse(r);return e.kind()==="ipv6"&&e.isIPv4MappedAddress()?e.toIPv4Address():e},u.subnetMatch=function(r,e,n){let t,o,i,l;n==null&&(n="unicast");for(o in e)if(Object.prototype.hasOwnProperty.call(e,o)){for(i=e[o],i[0]&&!(i[0]instanceof Array)&&(i=[i]),t=0;t<i.length;t++)if(l=i[t],r.kind()===l[0].kind()&&r.match.apply(r,l))return o}return n},typeof s<"u"&&s.exports?s.exports=u:f.ipaddr=u})(a)}),j={};er(j,{IPv4:()=>nr,IPv6:()=>ir,default:()=>G,fromByteArray:()=>b,isValid:()=>or,parse:()=>P,parseCIDR:()=>sr,process:()=>ar,subnetMatch:()=>ur});var N=V(_());tr(j,V(_()));var{IPv4:nr,IPv6:ir,fromByteArray:b,isValid:or,parse:P,parseCIDR:sr,process:ar,subnetMatch:ur}=N,{default:O,...fr}=N,G=O!==void 0?O:fr;function pr(a,s){s.write(new Uint8Array(2)),new DataView(s.buffer.buffer).setUint16(s.buffer.length-2,a)}function cr(a){return new DataView(a.read(2).buffer).getUint16(0)}function K(a,s){s.write(new Uint8Array(2)),new DataView(s.buffer.buffer).setInt16(s.buffer.length-2,a)}function W(a){return new DataView(a.read(2).buffer).getInt16(0)}var U=new Error("Invalid session string");function dr(a){return E(a).replaceAll("+","-").replaceAll("/","_")}function lr(a){return R(a.replaceAll("-","+").replaceAll("_","/"))}function hr(a){return E(a)}function wr(a){return R(a)}function Mr(a,s,f,p){let c=new g;return c.write(new Uint8Array([a,...P(s).toByteArray()])),pr(f,c),c.write(p),"1"+dr(c.buffer)}function Ur(a){if(a[0]!="1")throw U;a=a.slice(1);let s=new v(lr(a)),f=a.length==352,p=f?4:16,c=s.read(1)[0],h=b(s.read(p)).toString(),d=cr(s),w=s.buffer;return{dc:c,ip:h,ipv6:!f,port:d,authKey:w}}function Br(a,s,f,p){let c=new g;c.write(new Uint8Array([a]));let h=P(s).toByteArray();return K(h.length,c),c.write(new Uint8Array(h)),K(f,c),c.write(p),"1"+hr(c.buffer)}function Fr(a){if(a[0]!="1")throw U;a=a.slice(1);let s=new v(wr(a)),f=s.read(1)[0],p=W(s),c=b(s.read(p)).toString(),h=W(s),d=s.buffer;return{dc:f,ip:c,ipv6:p!=4,port:h,authKey:d}}function kr(a,s,f,p,c,h){let d=new g;return d.write(new Uint8Array([a])),d.write(C(s,32/8,!1,!1)),d.write(new Uint8Array([f?1:0])),d.write(p),d.write(C(c,64/8,!1,!1)),d.write(new Uint8Array([h?1:0])),y(d.buffer)}function zr(a){let s=new v(S(a));if(s.buffer.length!=271)throw U;let f=s.read(1)[0],p=Number($(s.read(32/8),!1,!1)),c=s.read(1)[0]==1,h=s.read(256),d=Number($(s.read(64/8),!1,!1)),w=s.read(1)[0]==1;return{dc:f,apiId:p,testMode:c,authKey:h,userId:d,isBot:w}}function Lr(a,s,f,p,c,h){let d=new g;d.write(new Uint8Array([3]));let w=Ir;return f!=null&&(w|=vr),a&&(w|=gr),d.writeInt32(w),d.writeBytes(q(s)),f!=null&&d.writeBytes(q(f)),d.writeInt64(BigInt(p)),d.writeInt32(c?2574415285:3162085175,!1),d.writeBytes(h),y(d.buffer)}function q(a){let s=new g;s.write(new Uint8Array([1])),s.write(new Uint8Array([a.id]));let f=0;return a.ip.includes(":")&&(f|=mr),a.media&&(f|=yr),s.write(new Uint8Array([f])),s.writeString(a.ip),s.writeInt32(a.port),s.buffer}var Ir=1,gr=2,vr=4,mr=1,yr=2;function Tr(a,s){let f=new g;return f.writeString(a),f.writeBytes(s),y(L(f.buffer))}function Or(a){let s=new v(T(S(a))),f=s.readString(),p=s.readBytes(),c=s.read(1)[0]==1,h=Number(s.readInt64());return{dc:f,authKey:p,isBot:c,userId:h}}export{Mr as a,Ur as b,Br as c,Fr as d,kr as e,zr as f,Lr as g,Tr as h,Or as i};
